<!DOCTYPE html>
<html>

<head>
  <title>Modo Competitivo</title>
  <script>
    window.onload = function () {
      // Duraci贸n de partida
      const totalTime = 5;

      // Hora en la que inici贸 la partida
      const gameStartedAt = <%= session[:game_started_at] %>;

      // Hora actual
      const now = Math.floor(Date.now() / 1000);

      // Tiempo de la partida
      let timeElapsed = now - gameStartedAt;

      // Tiempo restante
      let timeLeft = totalTime - timeElapsed;

      if (timeLeft <= 0) {
        // Contador lleg贸 a 0
        window.location.href = "/end_game_time";
      }

      document.getElementById("timer").innerHTML = timeLeft;

      // Actualizar contador
      const countdown = setInterval(function () {
        timeLeft -= 1;
        document.getElementById("timer").innerHTML = timeLeft;

        if (timeLeft <= 0) {
          // Contador lleg贸 a 0
          clearInterval(countdown);
          window.location.href = "/end_game_time";
        }
      }, 1000);
    };
  </script>
</head>

<body>
  <h1>Pregunta</h1>
  <p><%= @question.description %></p>

  <form action="/timetrial/submit_answer" method="post">
    <% @question.options.each do |option| %>
      <input type="radio" name="answer" value="<%= option.id %>" />
      <%= option.description %><br>
    <% end %>
    <button type="submit">Responder</button>
  </form>

  <p>Puntos: <%= @points %></p>
  <p>Racha: <%= @streak %></p>

  <p><strong>Tiempo restante:</strong> <span id="timer"></span> segundos</p>

</body>

</html>